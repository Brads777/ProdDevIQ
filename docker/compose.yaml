# GODMODEDEV Docker Compose
# Run: docker compose -f docker/compose.yaml up -d
# Run with shadcn: docker compose -f docker/compose.yaml --profile shadcn up -d

services:
  dev:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ../:/workspace
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1
    working_dir: /workspace
    stdin_open: true
    tty: true

  shadcn:
    profiles: ["shadcn"]
    build:
      context: .
      dockerfile: Dockerfile.shadcn
    ports:
      - "3333:3000"
    volumes:
      - shadcn-workspace:/app
      - shadcn-node-modules:/app/node_modules
    environment:
      - NODE_ENV=development
      - NEXT_TELEMETRY_DISABLED=1
    stdin_open: true
    tty: true

  shadcn-project:
    profiles: ["shadcn-project"]
    build:
      context: .
      dockerfile: Dockerfile.shadcn
    ports:
      - "3333:3000"
    volumes:
      - ${SHADCN_PROJECT_PATH:-./../shadcn-project}:/app
    environment:
      - NODE_ENV=development
      - NEXT_TELEMETRY_DISABLED=1
    stdin_open: true
    tty: true

volumes:
  shadcn-workspace:
  shadcn-node-modules:
